
# User Management API

This project is a simple User Management API built with ASP.NET Core. It includes JWT authentication and several middleware components for logging and error handling.

## Middleware

### TokenValidationMiddleware

This middleware is used to validate JWT tokens in incoming requests. It ensures that the token is valid and has not expired.

### Request and Response Logging Middleware

This middleware logs incoming requests and outgoing responses. It captures the request method, path, and body, as well as the response status code and body. The logs are saved to a file named `logs.txt`.

### Exception Handling Middleware

This middleware handles unhandled exceptions that occur during request processing. It logs the exception details and returns a generic error response to the client.

## Authentication

The API uses JWT (JSON Web Token) for authentication. The token is generated by the `/api/auth/token` endpoint and must be included in the `Authorization` header of subsequent requests to protected endpoints.

### Generating a Token

To generate a token, send a `POST` request to the `/api/auth/token` endpoint. The response will include a token that can be used for authentication.

Example request:
```bash
curl --location --request POST 'http://localhost:5000/api/auth/token'
```

Example response:
```json
{
    "token": "your-jwt-token-here"
}
```

### Using the Token

Include the token in the `Authorization` header of your requests to protected endpoints. The header should be in the following format:

```
Authorization: Bearer your-jwt-token-here
```

### Example Request with Token

```bash
curl --location --request GET 'http://localhost:5000/api/users/1' \
--header 'Authorization: Bearer your-jwt-token-here' \
--header 'Content-Type: application/json'
```

## Testing Credentials

For testing purposes, you can use the following credentials to generate a token:

- **Username:** `test`
- **Password:** `password`

These credentials are hardcoded in the `AuthController` for simplicity. In a real application, you should implement proper user authentication and validation.

## Configuration

The JWT settings are configured in the `appsettings.json` file. Make sure to update the `Key`, `Issuer`, and `Audience` values to match your requirements.

```json
{
  "Jwt": {
    "Key": "your-very-long-secret-key-that-is-at-least-32-characters-long",
    "Issuer": "your-issuer",
    "Audience": "your-audience"
  }
}
```

## Running the Application

To run the application, use the following command:

```bash
dotnet run
```

The API will be available at `http://localhost:5000`.

## Endpoints

- `GET /api/users` - Get all users
- `GET /api/users/{id}` - Get a user by ID
- `POST /api/users` - Create a new user
- `PUT /api/users/{id}` - Update a user
- `DELETE /api/users/{id}` - Delete a user

- `POST /api/auth/token` - Generate a JWT token

````

</file>

This README file provides an overview of the middleware used in the project, explains how to generate and use JWT tokens for authentication, and lists the available API endpoints.